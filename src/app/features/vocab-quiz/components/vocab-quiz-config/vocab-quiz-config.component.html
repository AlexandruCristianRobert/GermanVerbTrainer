<div class="min-h-screen bg-dark-900 py-4 px-4">
  <div class="max-w-3xl mx-auto animate-fade-in">
    <!-- Header -->
    <div class="mb-4 text-center">
      <h1 class="text-2xl font-bold text-gradient mb-1">Vocabulary Quiz</h1>
      <p class="text-sm text-gray-400">
        Test your knowledge of German verb translations
      </p>
    </div>

    <form [formGroup]="configForm" (ngSubmit)="startQuiz()" class="space-y-3">
      <!-- Custom List Selection Card -->
      <div
        class="bg-dark-800/80 backdrop-blur-lg shadow-card-dark rounded-lg border border-dark-600/50 p-4"
      >
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold text-white">Verb Source</h2>
          <a
            routerLink="/vocab-quiz/manage-verbs"
            class="text-xs text-accent-cyan hover:text-accent-purple transition-colors"
          >
            Manage Lists →
          </a>
        </div>

        <div class="flex items-center gap-3 mb-3">
          <label class="flex items-center gap-2 cursor-pointer">
            <input
              type="radio"
              [checked]="!configForm.get('useCustomList')?.value"
              (change)="configForm.patchValue({ useCustomList: false })"
              class="w-4 h-4 text-accent-cyan focus:ring-accent-cyan/30"
            />
            <span class="text-sm text-gray-300">All Verbs (by difficulty)</span>
          </label>

          <label class="flex items-center gap-2 cursor-pointer">
            <input
              type="radio"
              [checked]="configForm.get('useCustomList')?.value"
              (change)="configForm.patchValue({ useCustomList: true })"
              [disabled]="customLists.length === 0"
              class="w-4 h-4 text-accent-cyan focus:ring-accent-cyan/30"
            />
            <span class="text-sm text-gray-300">Custom List</span>
          </label>
        </div>

        <div *ngIf="configForm.get('useCustomList')?.value" class="mt-2">
          <select
            formControlName="customListId"
            class="w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded text-white focus:border-accent-cyan focus:ring-1 focus:ring-accent-cyan/30 text-sm"
          >
            <option *ngFor="let list of customLists" [value]="list.id">
              {{ list.name }} ({{ list.verbInfinitives.length }} verbs)
            </option>
          </select>
        </div>

        <div
          *ngIf="customLists.length === 0"
          class="mt-2 p-3 bg-warning-500/10 border border-warning-500/30 rounded"
        >
          <p class="text-xs text-warning-400">
            No custom lists yet.
            <a
              routerLink="/vocab-quiz/manage-verbs"
              class="underline hover:text-warning-300"
            >
              Create one
            </a>
            to practice specific verbs!
          </p>
        </div>
      </div>

      <!-- Difficulty Levels Card (only show if not using custom list) -->
      <div
        *ngIf="!configForm.get('useCustomList')?.value"
        class="bg-dark-800/80 backdrop-blur-lg shadow-card-dark rounded-lg border border-dark-600/50 p-4"
      >
        <h2 class="text-base font-semibold text-white mb-2">Difficulty</h2>

        <div class="flex flex-wrap gap-2">
          <button
            type="button"
            *ngFor="let option of difficultyLevelOptions"
            (click)="toggleLevel(option.level)"
            class="px-3 py-1.5 rounded text-xs font-medium transition-all border"
            [ngClass]="{
              'border-accent-cyan bg-accent-cyan/20 text-white':
                isLevelSelected(option.level),
              'border-dark-600 bg-dark-700/50 text-gray-400 hover:border-dark-500':
                !isLevelSelected(option.level)
            }"
            [title]="option.description"
          >
            {{ option.label }}
          </button>
        </div>

        <p
          *ngIf="
            configForm.get('difficultyLevels')?.invalid &&
            configForm.get('difficultyLevels')?.touched
          "
          class="text-xs text-error-400 mt-2"
        >
          Please select at least one difficulty level
        </p>
      </div>

      <!-- Verb Count Card -->
      <div
        class="bg-dark-800/80 backdrop-blur-lg shadow-card-dark rounded-lg border border-dark-600/50 p-4"
      >
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-base font-semibold text-white">Verbs</h2>
          <span class="text-lg font-bold text-accent-cyan">{{
            configForm.get("verbCount")?.value
          }}</span>
        </div>

        <input
          type="range"
          formControlName="verbCount"
          min="5"
          max="100"
          step="5"
          class="w-full h-2 bg-dark-700 rounded appearance-none cursor-pointer slider"
        />

        <div class="flex justify-between text-xs text-gray-500 mt-1">
          <span>5</span>
          <span>100</span>
        </div>

        <div
          class="mt-3 p-2 bg-accent-cyan/10 border border-accent-cyan/30 rounded"
        >
          <p class="text-xs text-gray-300">
            <span class="font-semibold text-accent-cyan">{{
              availableVerbsCount
            }}</span>
            available
          </p>
        </div>
      </div>

      <!-- Preview Section -->
      <div
        class="bg-dark-800/80 backdrop-blur-lg shadow-card-dark rounded-lg border border-dark-600/50 p-3"
      >
        <button
          type="button"
          (click)="togglePreview()"
          class="w-full flex items-center justify-between text-left"
        >
          <h2 class="text-sm font-semibold text-white">Preview</h2>
          <svg
            class="w-4 h-4 text-gray-400 transition-transform"
            [class.rotate-180]="showPreview"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            />
          </svg>
        </button>

        <div *ngIf="showPreview" class="mt-3 space-y-2">
          <div
            *ngFor="let verb of previewVerbs"
            class="p-2 bg-dark-700 rounded flex justify-between items-center"
          >
            <span class="text-xs font-semibold text-white">{{
              verb.infinitive
            }}</span>
            <span class="text-xs text-gray-300">{{
              verb.english_translation
            }}</span>
          </div>

          <p
            *ngIf="previewVerbs.length === 0"
            class="text-xs text-gray-500 text-center py-3"
          >
            No verbs available
          </p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-2">
        <button
          type="submit"
          [disabled]="
            configForm.invalid ||
            availableVerbsCount < configForm.get('verbCount')?.value
          "
          class="flex-1 bg-gradient-to-r from-accent-cyan to-accent-purple text-white px-4 py-2 rounded font-semibold hover:shadow-glow-cyan transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm"
        >
          Start Quiz →
        </button>

        <button
          type="button"
          (click)="resetToDefaults()"
          class="px-4 py-2 border border-dark-600 rounded text-gray-300 hover:bg-dark-700 hover:border-dark-500 transition-all text-sm"
        >
          Reset
        </button>
      </div>
    </form>
  </div>
</div>
